<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ColorFulCraft | æŠ€æœ¯æ–‡æ¡£ä¸­å¿ƒ</title>
    
    <link rel="icon" type="image/x-icon" href="pictures/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="pictures/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="pictures/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="pictures/apple-touch-icon.png">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsify@4/lib/themes/vue.css">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; height: 100vh; overflow-x: hidden; position: relative; cursor: default; }
        
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%; animation: gradientFlow 15s ease infinite; z-index: -2;
        }
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .content-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.7); backdrop-filter: blur(3px); z-index: -1;
        }
        #app { position: relative; z-index: 1; min-height: 100vh; }
        
        .back-button { position: fixed; top: 20px; left: 20px; z-index: 1000; }
        .back-btn {
            padding: 12px 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; border-radius: 25px; text-decoration: none; font-weight: 500;
            transition: all 0.3s ease; backdrop-filter: blur(10px); border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer; display: flex; align-items: center; gap: 8px;
        }
        .back-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3); }
        
        .markdown-section {
            max-width: 900px !important; margin: 0 auto !important; padding: 40px !important;
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .sidebar { width: 260px !important; padding: 20px !important; background: rgba(255, 255, 255, 0.95) !important; backdrop-filter: blur(10px); border-right: 1px solid rgba(255, 255, 255, 0.2); }
        .sidebar-nav { padding-left: 0 !important; }
        .sidebar-nav li { list-style: none !important; margin: 10px 0 !important; }
        .sidebar-nav a { color: #333 !important; text-decoration: none !important; padding: 8px 15px !important; border-radius: 5px !important; display: block !important; transition: all 0.3s ease !important; }
        .sidebar-nav a:hover { background: rgba(102, 126, 234, 0.1) !important; color: #667eea !important; }
        
        body.dark-mode .gradient-bg { filter: brightness(0.6) hue-rotate(25deg); }
        body.dark-mode .content-overlay { background: rgba(0, 0, 0, 0.85); }
        body.dark-mode .markdown-section { background: rgba(40, 40, 40, 0.95); color: #f0f0f0; }
        body.dark-mode .sidebar { background: rgba(40, 40, 40, 0.95) !important; }
        body.dark-mode .sidebar-nav a { color: #f0f0f0 !important; }
        body.dark-mode .sidebar-nav a:hover { background: rgba(255, 165, 0, 0.1) !important; color: #ffa500 !important; }
        body.dark-mode .app-nav { background: rgba(40, 40, 40, 0.9) !important; }
        body.dark-mode .search input { background: rgba(60, 60, 60, 0.9) !important; color: #f0f0f0; }
        
        .markdown-section h1 { font-size: 2.5rem !important; margin-bottom: 1.5rem !important; border-bottom: 2px solid #667eea !important; padding-bottom: 0.5rem !important; color: #333 !important; }
        body.dark-mode .markdown-section h1 { border-bottom-color: #ffa500 !important; color: #f0f0f0 !important; }
        
        .app-nav { background: rgba(255, 255, 255, 0.9) !important; backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255, 255, 255, 0.2); }
        .search input { background: rgba(255, 255, 255, 0.9) !important; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3) !important; }
        
        @media (max-width: 768px) {
            .markdown-section { margin: 10px !important; padding: 20px !important; }
            .back-button { top: 10px; left: 10px; }
            .back-btn { padding: 10px 16px; font-size: 0.9rem; }
            .sidebar { width: 200px !important; }
        }
    </style>
</head>
<body>
    <div class="gradient-bg"></div>
    <div class="content-overlay"></div>
    
    <div class="back-button">
        <button class="back-btn" onclick="window.location.href='index.html'">
            <span>â†</span> è¿”å›é¦–é¡µ
        </button>
    </div>
    
    <div id="app"></div>
    
    <script>
        window.$docsify = {
            name: 'ğŸ›ï¸ ColorFulCraft æŠ€æœ¯æ–‡æ¡£ä¸­å¿ƒ',
            repo: 'ColorFulCraft/CFCHistory',
            loadSidebar: true,
            subMaxLevel: 2,
            autoHeader: true,
            auto2top: true,
            homepage: 'README.md',
            
            search: {
                paths: 'auto',
                placeholder: 'ğŸ” æœç´¢æ–‡æ¡£...',
                noData: 'ğŸ˜… æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ç»“æœ',
                depth: 3,
                hideOtherSidebarContent: false,
                namespace: 'cfc-docs'
            },
            
            themeColor: '#667eea',
            
            plugins: [
                // åŠ¨æ€ä¾§è¾¹æ ç”Ÿæˆæ’ä»¶
                function(hook, vm) {
                    hook.mounted(function() {
                        // é¡µé¢åŠ è½½å®ŒæˆååŠ¨æ€ç”Ÿæˆä¾§è¾¹æ 
                        generateDynamicSidebar();
                    });
                    
                    hook.beforeEach(function(content) {
                        const editUrl = 'https://github.com/ColorFulCraft/CFCHistory/blob/main/docs/' + vm.route.file;
                        return content + '\n\n---\n\n' +
                            '> **ğŸ“ æ–‡æ¡£ä¿¡æ¯** | æœ€åæ›´æ–°: ' + new Date().toLocaleDateString('zh-CN') + 
                            ' | [åœ¨GitHubä¸Šç¼–è¾‘æ­¤é¡µ](' + editUrl + ')\n';
                    });
                    
                    hook.doneEach(function() {
                        if (localStorage.getItem('theme') === 'dark') {
                            document.body.classList.add('dark-mode');
                        }
                    });
                }
            ]
        };
        
        // ğŸ”¥ åŠ¨æ€ç”Ÿæˆä¾§è¾¹æ å‡½æ•°
        async function generateDynamicSidebar() {
            try {
                // è·å–docsç›®å½•ç»“æ„
                const response = await fetch('https://api.github.com/repos/ColorFulCraft/CFCHistory/contents/docs');
                const files = await response.json();
                
                // ç­‰å¾…Docsifyä¾§è¾¹æ åŠ è½½å®Œæˆ
                setTimeout(() => {
                    const sidebar = document.querySelector('.sidebar-nav');
                    if (sidebar) {
                        // æ¸…ç©ºç°æœ‰å†…å®¹
                        sidebar.innerHTML = '';
                        
                        // æ„å»ºä¾§è¾¹æ HTML
                        const sidebarHTML = buildSidebarHTML(files);
                        sidebar.innerHTML = sidebarHTML;
                        
                        // é‡æ–°åˆå§‹åŒ–Docsifyçš„ä¾§è¾¹æ åŠŸèƒ½
                        if (window.$docsify.router) {
                            window.$docsify.router.update();
                        }
                    }
                }, 1000); // ç»™Docsifyä¸€ç‚¹æ—¶é—´åˆå§‹åŒ–
                
            } catch (error) {
                console.error('è·å–ç›®å½•å¤±è´¥:', error);
                // å›é€€åˆ°é»˜è®¤ä¾§è¾¹æ 
                setTimeout(() => {
                    const sidebar = document.querySelector('.sidebar-nav');
                    if (sidebar) {
                        sidebar.innerHTML = `
                            <li><a href="#/README.md">ğŸ  æ–‡æ¡£é¦–é¡µ</a></li>
                            <li><a href="#/Directory.md">ğŸ“– ç›®å½•æ€»è§ˆ</a></li>
                            <li><a href="#/about.md">ğŸ¨ ç®¡ç†å›¢é˜Ÿ</a></li>
                            <li><a href="#/history.md">ğŸ“œ å†å²è®°è½½</a></li>
                        `;
                    }
                }, 1000);
            }
        }
        
        // ğŸ”¥ æ„å»ºä¾§è¾¹æ HTML
        function buildSidebarHTML(files) {
            // æŒ‰ç±»å‹åˆ†ç±»æ–‡ä»¶
            const categories = {
                'é¦–é¡µ': [],
                'ç›®å½•': [],
                'å›¢é˜Ÿ': [],
                'å†å²': []
            };
            
            // å¤„ç†æ–‡ä»¶åˆ†ç±»
            files.forEach(file => {
                if (file.type === 'file' && file.name.endsWith('.md')) {
                    const fileName = file.name;
                    const displayName = getDisplayName(fileName);
                    
                    if (fileName === 'README.md') {
                        categories['é¦–é¡µ'].push({name: displayName, file: fileName});
                    } else if (fileName === 'Directory.md') {
                        categories['ç›®å½•'].push({name: displayName, file: fileName});
                    } else if (fileName === 'about.md') {
                        categories['å›¢é˜Ÿ'].push({name: displayName, file: fileName});
                    } else if (fileName.startsWith('history')) {
                        // è§£æå†å²é¡µç 
                        const pageNum = extractPageNumber(fileName);
                        categories['å†å²'].push({
                            name: displayName, 
                            file: fileName,
                            pageNum: pageNum
                        });
                    }
                }
            });
            
            // å¯¹å†å²æ–‡æ¡£æŒ‰é¡µç æ’åº
            categories['å†å²'].sort((a, b) => {
                if (a.pageNum === undefined) return 1;
                if (b.pageNum === undefined) return -1;
                return a.pageNum - b.pageNum;
            });
            
            // ç”ŸæˆHTML
            let html = '';
            
            // é¦–é¡µ
            categories['é¦–é¡µ'].forEach(item => {
                html += `<li><a href="#/${item.file}">${item.name}</a></li>`;
            });
            
            // ç›®å½•
            if (categories['ç›®å½•'].length > 0) {
                html += '<li class="sidebar-category">ğŸ“– ç›®å½•</li>';
                categories['ç›®å½•'].forEach(item => {
                    html += `<li><a href="#/${item.file}">${item.name}</a></li>`;
                });
            }
            
            // å›¢é˜Ÿ
            if (categories['å›¢é˜Ÿ'].length > 0) {
                html += '<li class="sidebar-category">ğŸ¨ ç®¡ç†å›¢é˜Ÿ</li>';
                categories['å›¢é˜Ÿ'].forEach(item => {
                    html += `<li><a href="#/${item.file}">${item.name}</a></li>`;
                });
            }
            
            // å†å²
            if (categories['å†å²'].length > 0) {
                html += '<li class="sidebar-category">ğŸ“œ å†å²è®°è½½</li>';
                categories['å†å²'].forEach(item => {
                    html += `<li><a href="#/${item.file}">${item.name}</a></li>`;
                });
            }
            
            // æ·»åŠ å¤–éƒ¨é“¾æ¥
            html += `
                <li class="sidebar-category">ğŸ”— å¿«é€Ÿé“¾æ¥</li>
                <li><a href="../index.html">ğŸ  è¿”å›é¦–é¡µ</a></li>
                <li><a href="https://github.com/ColorFulCraft/CFCHistory" target="_blank">â­ GitHubä»“åº“</a></li>
                <li><a href="https://qm.qq.com/q/L8kNa8IJqu" target="_blank">ğŸ‘¥ åŠ å…¥QQç¾¤</a></li>
            `;
            
            return html;
        }
        
        // ğŸ”¥ è·å–æ˜¾ç¤ºåç§°
        function getDisplayName(fileName) {
            const nameMap = {
                'README.md': 'ğŸ  æ–‡æ¡£é¦–é¡µ',
                'Directory.md': 'ğŸ“– ç›®å½•æ€»è§ˆ',
                'about.md': 'ğŸ¨ ç®¡ç†å›¢é˜Ÿä»‹ç»',
                'history.md': 'ğŸ“œ å†å²è®°è½½ï¼ˆç¬¬ä¸€é¡µï¼‰'
            };
            
            if (nameMap[fileName]) {
                return nameMap[fileName];
            }
            
            // å¤„ç†å†å²æ–‡æ¡£
            if (fileName.startsWith('history')) {
                const baseName = fileName.replace('.md', '');
                const pageNum = extractPageNumber(fileName);
                
                if (fileName === 'history.md') {
                    return 'ğŸ“œ å†å²è®°è½½ï¼ˆç¬¬ä¸€é¡µï¼‰';
                } else if (pageNum) {
                    return `ğŸ“œ å†å²è®°è½½ï¼ˆç¬¬${pageNum}é¡µï¼‰`;
                } else {
                    return `ğŸ“œ ${baseName}`;
                }
            }
            
            // é»˜è®¤å¤„ç†
            return fileName.replace('.md', '');
        }
        
        // ğŸ”¥ æå–é¡µç 
        function extractPageNumber(fileName) {
            const match = fileName.match(/history_?(\d+)\.md$/);
            if (match && match[1]) {
                return parseInt(match[1]);
            }
            
            // å¤„ç† history_2.md, history_3.md ç­‰æ ¼å¼
            const simpleMatch = fileName.match(/history_(\d+)\.md$/);
            if (simpleMatch && simpleMatch[1]) {
                return parseInt(simpleMatch[1]);
            }
            
            return null;
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/docsify@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/docsify/lib/plugins/search.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docsify/lib/plugins/zoom-image.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/docsify-copy-code"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (localStorage.getItem('theme') === 'dark') {
                document.body.classList.add('dark-mode');
            }
            
            // æ·»åŠ ä¾§è¾¹æ åˆ†ç±»æ ·å¼
            const style = document.createElement('style');
            style.textContent = `
                .sidebar-category {
                    margin-top: 20px !important;
                    font-weight: bold !important;
                    color: #667eea !important;
                    padding: 10px 15px !important;
                    background: rgba(102, 126, 234, 0.1) !important;
                    border-radius: 5px !important;
                }
                body.dark-mode .sidebar-category {
                    color: #ffa500 !important;
                    background: rgba(255, 165, 0, 0.1) !important;
                }
            `;
            document.head.appendChild(style);
        });
    </script>
</body>
</html>
